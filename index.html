<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Organic Synthesis Quiz - Dark Glass UI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Glassmorphism backdrop */
    .glass {
      background: rgba(255 255 255 / 0.07);
      backdrop-filter: saturate(180%) blur(18px);
      -webkit-backdrop-filter: saturate(180%) blur(18px);
      border-radius: 1rem;
      border: 1px solid rgba(255 255 255 / 0.15);
    }

    body {
      font-family: 'Poppins', sans-serif;
    }

    /* Custom focus for accessibility */
    button:focus-visible {
      outline: 3px solid #8b5cf6;
      /* violet-500 */
      outline-offset: 2px;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
</head>

<body
  class="bg-gradient-to-tr from-gray-900 via-gray-800 to-gray-900 min-h-screen flex items-center justify-center p-6 sm:p-12">

  <main
    class="glass max-w-lg w-full p-8 sm:p-12 flex flex-col items-center text-gray-200 shadow-xl shadow-black/70 select-none">

    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight mb-8 text-center drop-shadow-lg">
      Organic Synthesis Quiz
    </h1>

    <!-- Step selector -->
    <section id="step-selector" class="flex gap-8 mb-8">
      <button onclick="startQuiz(1)"
        class="px-8 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-800 transition font-semibold text-lg shadow-md shadow-indigo-700/50">
        1 Step
      </button>
      <button onclick="startQuiz(2)"
        class="px-8 py-3 rounded-xl bg-green-600 hover:bg-green-700 active:bg-green-800 transition font-semibold text-lg shadow-md shadow-green-700/50">
        2 Steps
      </button>
    </section>

    <!-- Quiz Section -->
    <section id="quiz-section" class="hidden w-full flex flex-col items-center space-y-8">

      <p id="question" class="text-2xl sm:text-3xl font-semibold leading-relaxed text-center max-w-full drop-shadow-md">
      </p>

      <button id="show-answer-btn" onclick="showAnswer()"
        class="w-full sm:w-auto px-10 py-3 rounded-xl bg-purple-600 hover:bg-purple-700 active:bg-purple-800 transition font-semibold text-lg shadow-md shadow-purple-700/50">
        Show Answer
      </button>

      <p id="answer"
        class="whitespace-pre-line text-lg sm:text-xl text-green-400 font-semibold max-w-full hidden drop-shadow-md">
      </p>

      <div class="flex gap-6 w-full max-w-md justify-center">
        <button id="next-question-btn" onclick="nextQuestion()"
          class="hidden px-10 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 active:bg-blue-800 transition font-semibold text-lg shadow-md shadow-blue-700/50">
          Next Question
        </button>
        <button id="change-mode-btn" onclick="resetQuiz()"
          class="px-10 py-3 rounded-xl bg-gray-700 hover:bg-gray-600 active:bg-gray-500 transition font-semibold text-lg shadow-md shadow-gray-800/70">
          Change Mode
        </button>
      </div>
    </section>
  </main>

  <script>
    const synthesisMap = {
      Alkane: {
        Haloalkane: [["Free radical substitution", ["Cl2 or Br2", "UV light"]]],
      },
      Alkene: {
        Alkane: [["Hydrogenation", ["H2", "Ni", "150°C"]]],
        Alcohol: [["Hydration", ["Steam", "H3PO4", "300°C", "60 atm"]]],
        Haloalkane: [["Electrophilic addition", ["HX"]], ["Halogenation", ["Cl2 or Br2"]]],
      },
      Haloalkane: {
        Alcohol: [["Nucleophilic substitution", ["NaOH (aq)", "Warm"]]],
      },
      Alcohol: {
        Alkene: [["Dehydration", ["Conc. H2SO4 or Al2O3", "Heat"]]],
        Aldehyde: [["Partial oxidation", ["K2Cr2O7", "H2SO4", "Distil"]]],
        Carboxylic_Acid: [["Complete oxidation", ["K2Cr2O7", "H2SO4", "Reflux"]]],
      },
      Aldehyde: {
        Carboxylic_Acid: [["Oxidation", ["K2Cr2O7", "H2SO4", "Reflux"]]],
      },
    };

    let currentAnswer = "";
    let currentStepCount = 0;

    const stepSelector = document.getElementById("step-selector");
    const quizSection = document.getElementById("quiz-section");
    const questionEl = document.getElementById("question");
    const answerEl = document.getElementById("answer");
    const showAnswerBtn = document.getElementById("show-answer-btn");
    const nextQuestionBtn = document.getElementById("next-question-btn");
    const changeModeBtn = document.getElementById("change-mode-btn");

    function getRandomProperty(obj) {
      const keys = Object.keys(obj);
      return keys[Math.floor(Math.random() * keys.length)];
    }

    function startQuiz(steps) {
      currentStepCount = steps;
      stepSelector.classList.add("hidden");
      quizSection.classList.remove("hidden");
      answerEl.classList.add("hidden");
      nextQuestionBtn.classList.add("hidden");
      showAnswerBtn.classList.remove("hidden");
      generateQuestion();
    }

    function generateQuestion() {
      answerEl.classList.add("hidden");
      nextQuestionBtn.classList.add("hidden");
      showAnswerBtn.classList.remove("hidden");
      answerEl.textContent = "";

      if (currentStepCount === 1) {
        generateOneStep();
      } else if (currentStepCount === 2) {
        generateTwoStep();
      }
    }

    function generateOneStep() {
      const from = getRandomProperty(synthesisMap);
      const to = getRandomProperty(synthesisMap[from]);
      const options = synthesisMap[from][to];
      const [method, conditions] = options[Math.floor(Math.random() * options.length)];

      questionEl.textContent = `How do you convert ${formatName(from)} to ${formatName(to)}?`;
      currentAnswer = `${method}: ${conditions.join(", ")}`;
    }

    function generateTwoStep() {
      let from, mid, to, path1, path2;
      for (let i = 0; i < 1000; i++) {
        from = getRandomProperty(synthesisMap);
        mid = getRandomProperty(synthesisMap[from]);
        if (!synthesisMap[mid]) continue;
        to = getRandomProperty(synthesisMap[mid]);
        if (to && synthesisMap[mid][to]) {
          path1 = synthesisMap[from][mid][Math.floor(Math.random() * synthesisMap[from][mid].length)];
          path2 = synthesisMap[mid][to][Math.floor(Math.random() * synthesisMap[mid][to].length)];
          break;
        }
      }

      questionEl.textContent = `How do you convert ${formatName(from)} to ${formatName(to)} in 2 steps?`;
      currentAnswer = `Step 1 - ${path1[0]}: ${path1[1].join(", ")}\nStep 2 - ${path2[0]}: ${path2[1].join(", ")}`;
    }

    function formatName(str) {
      return str.replace(/_/g, " ");
    }

    function showAnswer() {
      answerEl.textContent = currentAnswer;
      answerEl.classList.remove("hidden");
      showAnswerBtn.classList.add("hidden");
      nextQuestionBtn.classList.remove("hidden");
    }

    function nextQuestion() {
      generateQuestion();
    }

    function resetQuiz() {
      quizSection.classList.add("hidden");
      stepSelector.classList.remove("hidden");
      answerEl.classList.add("hidden");
      showAnswerBtn.classList.remove("hidden");
      nextQuestionBtn.classList.add("hidden");
      questionEl.textContent = "";
      answerEl.textContent = "";
      currentAnswer = "";
      currentStepCount = 0;
    }
  </script>
</body>

</html>